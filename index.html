<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Te quiero mucho ðŸ’˜</title>
  <meta name="description" content="PÃ¡gina con fondo negro, fuegos artificiales, Spotify fijo, confeti y botones SÃ­ / No." />
  <!-- TipografÃ­a bonita y legible -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#000; --text:#fff; --accent:#ff2d2d; }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:'Nunito',system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}

    #sky{position:fixed;inset:0;z-index:-1;background:#000}

    .wrap{min-height:100dvh;display:flex;align-items:center;justify-content:center;padding:24px}
    .card{width:min(980px,100%);display:grid;gap:18px;place-items:center;text-align:center}

    h1{font-size:clamp(44px,8vw,92px);letter-spacing:.5px;margin:0;font-weight:900}
    .sub{font-size:clamp(26px,5vw,48px);opacity:.95;margin-top:0;font-weight:700}

    .question{margin-top:8px;font-size:clamp(14px,2.5vw,18px);opacity:.9}

    .btns{display:flex;gap:14px;margin-top:6px}
    button{appearance:none;border:0;cursor:pointer;transition:.18s transform ease, .18s opacity ease, .18s filter ease;
      background:var(--accent);color:#fff;padding:14px 26px;border-radius:999px;font-weight:800;font-size:18px;
      box-shadow:0 10px 24px rgba(255,45,45,.25), inset 0 -2px 0 rgba(0,0,0,.2);}
    button:active{transform:scale(.96)}
    #noBtn:active{transform:scale(.86)}

    .player{width:min(560px,100%);height:80px;border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,.12)}
    .fallback{margin-top:6px;font-size:13px;opacity:.9}
    .fallback a{color:#ff9; text-decoration:underline}

    .toast{position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(20,20,20,.8);
      border:1px solid rgba(255,255,255,.2);border-radius:14px;padding:10px 14px;font-weight:800;backdrop-filter:blur(6px);
      opacity:0;pointer-events:none;transition:opacity .25s ease}
    .toast.show{opacity:1}

    .emojis{position:fixed;inset:0;pointer-events:none;overflow:hidden}
    .emoji{position:absolute;font-size:32px;opacity:0;animation:floatUp 1.2s ease forwards}
    @keyframes floatUp{from{transform:translateY(0) scale(.9);opacity:0}50%{opacity:1}to{transform:translateY(-120px) scale(1.1);opacity:0}}
  </style>
</head>
<body>
  <canvas id="sky"></canvas>

  <div class="wrap">
    <div class="card">
      <div>
        <h1>TE QUIERO MUCHO</h1>
        <div class="sub">TE EXTRAÃ‘OðŸ«¶</div>
      </div>

      <div id="playerWrap" class="player">
        <iframe id="spotifyFrame" style="border:0;width:100%;height:100%" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
          loading="lazy"
          src="https://open.spotify.com/embed/track/2k6FKrR0wDIs6xCtU51GZ7?utm_source=generator&theme=0&autoplay=1"></iframe>
      </div>
      <div id="fallbackMsg" class="fallback" style="display:none">
        Si no ves el reproductor, abre la canciÃ³n aquÃ­: 
        <a id="openSpotify" href="https://open.spotify.com/track/2k6FKrR0wDIs6xCtU51GZ7" target="_blank" rel="noopener">Abrir en Spotify</a>
      </div>

      <div class="question">ME PERDONAS?</div>
      <div class="btns">
        <button id="yesBtn" aria-label="SÃ­">SI</button>
        <button id="noBtn" aria-label="No">NO</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast">GRACIAAAS TE QUIERO MUCHO</div>
  <div id="emojis" class="emojis"></div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script>
    const yes = document.getElementById('yesBtn');
    const no = document.getElementById('noBtn');
    const toast = document.getElementById('toast');
    const emojisLayer = document.getElementById('emojis');
    const frame = document.getElementById('spotifyFrame');
    const fallback = document.getElementById('fallbackMsg');

    // Intento de detecciÃ³n y fallback si el embed no carga (bloqueos, extensiones o file://)
    let loaded = false;
    frame.addEventListener('load', ()=>{ loaded = true; });
    setTimeout(()=>{ if(!loaded){ fallback.style.display='block'; } }, 2500);

    yes.addEventListener('click', ()=>{
      const duration = 1200; const end = Date.now() + duration;
      (function frameLoop(){
        confetti({ particleCount: 8, startVelocity: 40, spread: 60, origin: { x: Math.random(), y: 0.6 } });
        if(Date.now() < end) requestAnimationFrame(frameLoop);
      })();
      toast.classList.add('show'); setTimeout(()=> toast.classList.remove('show'), 1600);
    });

    no.addEventListener('click', (e)=>{
      const rect = e.target.getBoundingClientRect();
      const centerX = rect.left + rect.width/2; const centerY = rect.top + rect.height/2;
      const batches = 12;
      for(let i=0;i<batches;i++){
        const span = document.createElement('span');
        span.className = 'emoji'; span.textContent = 'ðŸ™„';
        const x = Math.random()*window.innerWidth*0.9 + window.innerWidth*0.05;
        const y = Math.random()*window.innerHeight*0.6 + window.innerHeight*0.2;
        const useBtn = Math.random() < 0.5;
        span.style.left = (useBtn? centerX + (Math.random()-0.5)*80 : x) + 'px';
        span.style.top  = (useBtn? centerY + (Math.random()-0.5)*20 : y) + 'px';
        span.style.animationDelay = (Math.random()*0.15)+'s';
        emojisLayer.appendChild(span);
        setTimeout(()=> span.remove(), 1400);
      }
      no.style.transition = 'transform .18s ease, opacity .18s ease';
      no.style.transform = 'scale(0.7)';
      no.style.opacity = '0';
      setTimeout(()=> no.remove(), 200);
    });

    // Fuegos artificiales
    (function fireworks(){
      const c = document.getElementById('sky');
      const ctx = c.getContext('2d');
      let W, H, dpr = Math.max(1, Math.min(2, window.devicePixelRatio||1));
      function resize(){ W = c.width = Math.floor(innerWidth*dpr); H = c.height = Math.floor(innerHeight*dpr); c.style.width=innerWidth+'px'; c.style.height=innerHeight+'px'; }
      window.addEventListener('resize', resize, {passive:true}); resize();

      const GRAV = 0.06 * dpr; const sparks = [];
      function launch(){
        const x = (Math.random()*0.8+0.1)*W; const y = H + 10*dpr;
        const vx = (Math.random()-0.5)*1.2*dpr; const vy = -(Math.random()*3.5+5.5)*dpr;
        const color = `hsl(${Math.floor(Math.random()*360)},100%,60%)`;
        sparks.push({type:'rocket', x,y,vx,vy, life:0, color});
      }
      function burst(x,y,color){
        const count = 80;
        for(let i=0;i<count;i++){
          const a = Math.random()*Math.PI*2; const sp = Math.random()*3.5 + 1.5;
          sparks.push({type:'spark', x,y, vx:Math.cos(a)*sp, vy:Math.sin(a)*sp, life:0, color, drag:0.99});
        }
      }
      let last = 0;
      function tick(t){
        requestAnimationFrame(tick);
        ctx.fillStyle = 'rgba(0,0,0,0.25)'; ctx.fillRect(0,0,W,H);
        if(!last || t-last > 700){ launch(); last = t; }
        for(let i=sparks.length-1;i>=0;i--){
          const p = sparks[i];
          if(p.type==='rocket'){
            p.x += p.vx; p.y += p.vy; p.vy += GRAV*-0.4; p.life++;
            ctx.beginPath(); ctx.fillStyle = '#fff'; ctx.arc(p.x,p.y,1.6*dpr,0,Math.PI*2); ctx.fill();
            if(p.vy> -0.2 || Math.random()<0.002){ burst(p.x,p.y,p.color); sparks.splice(i,1); }
          } else {
            p.vx *= p.drag; p.vy = p.vy * p.drag + GRAV; p.x += p.vx; p.y += p.vy; p.life++;
            const alpha = Math.max(0, 1 - p.life/90);
            ctx.beginPath(); ctx.fillStyle = p.color.replace('60%)', `60% / ${alpha})`).replace('hsl','hsl');
            ctx.arc(p.x,p.y,1.1*dpr,0,Math.PI*2); ctx.fill();
            if(alpha<=0){ sparks.splice(i,1); }
          }
        }
      }
      requestAnimationFrame(tick);
    })();
  </script>
</body>
</html>
